Скрипт twoAllel_to_refAlt.py предназначен для конвертации файла из формата
«#CHROM\<TAB\>POS\<TAB\>ID\<TAB\>allele1\<TAB\>allele2» в формат «#CHROM\<TAB\>POS\<TAB\>ID\<TAB\>REF\<TAB\>ALT». Он выявляет, какой из двух аллелей во входном файле
(«allele1», «allele2») является референсным, а какой – альтернативным на основе последовательности референсного генома. Если ни один из аллелей не является референсным, такие строки пропускаются.

Перед запуском скрипта для конвертации файла FP_SNPs.txt его необходимо привести к корректному формату при помощи команды:

> awk -F'\t' 'BEGIN {OFS="\t"} NR == 1 {print "#CHROM", "POS", "ID", "allele1", "allele2"; next} $2 != 23 {print "chr"$2, $4, "rs"$1, $5, $6}' FP_SNPs.txt > FP_SNPs_10k_GB38_twoAllelsFormat.tsv

Данная команда преобразовывает файл FP_SNPs.txt таким образом, чтобы формат входного файла стал максимально похож по формату на VCF и пригоден для популяционных исследований. В файле удаляются координаты по GRCh37, в правильном порядке выставляются колонки, добавлены префиксы chr и rs, а также удалены варианты с X-хромосомы. 

Референсный геном должен быть разбит на последовательности, соответствующие основным хромосомам (chr1, chr2, ..., chr22, chrX, chrY, chrM). Если файлы не проиндексированы на момент работы скрипта, при первом запуске будут сформированы индексы для более быстрой конвертации. Для запуска скрипта необходимо указать пути до входного файла (--input), получаемого файла (--output) и до директории с файлами референского генома (--reference_dir). 

В результате работы скрипта с входным файлом FP_SNPs_10k_GB38_twoAllelesFormat.tsv получен файл с информацией о референсных и альтернативных аллелях соматических хромосом (FP_SNPs_10k_GB38_refAltFormat.tsv). При этом не удалось сконвертировать 9 строк, в которых ни один аллель не был определен как референсный.
